# Event Log Readers

#### **Overview**

The **Event Log Readers** group in Windows is designed to allow its members to read the event logs on a system. This group typically includes users who need to monitor or analyze system and application events without granting them broader administrative privileges.

#### **Privileges Granted**

Members of the Event Log Readers group have the following privileges:

* **Read Event Logs**: Users can access and read the event logs generated by the Windows operating system, applications, and services.
* **View Security Logs**: This includes access to security-related events, which may contain sensitive information such as user logins, account changes, and security policy changes.

#### **Potential for Privilege Escalation**

While the **Event Log Readers** group does not inherently grant high privileges, there are specific scenarios where these members could potentially escalate their privileges:

1. **Analyzing Security Logs**:
   * By reviewing security logs, a user may identify sensitive information, such as account credentials, account lockouts, or changes made by other users. This information could potentially be leveraged to gain unauthorized access to accounts or systems.
2. **Identifying Vulnerabilities**:
   * Users can analyze event logs to identify misconfigurations or vulnerabilities in the system. For example, if an administrator frequently logs in and out or if there are repeated failed login attempts, this could indicate weak passwords or poorly secured accounts.
3. **Targeting Other Users**:
   * Information from event logs can help identify high-privilege accounts and their activity patterns. An attacker could use this information to craft targeted attacks, such as phishing or social engineering, against those users.
4. **Leveraging Log Access for Other Attacks**:
   * If a user can read event logs, they may be able to manipulate logging services or other components to perform actions with higher privileges, especially if there are vulnerabilities or misconfigurations in those services.

## **Searching Security Logs Using wevtutil**

The `wevtutil` command-line utility is a powerful tool for managing Windows Event Logs. It can be used to query event logs and retrieve information based on specific criteria. In this example, we will focus on querying the **Security** log to find specific user-related events.

**Example Command**

```powershell
PS C:\htb> wevtutil qe Security /rd:true /f:text | Select-String "/user"
```

**Breakdown of the Command:**

* **`wevtutil`**: This is the command-line utility for Windows Event Log management.
* **`qe Security`**: This option specifies that we want to query the **Security** log.
* **`/rd:true`**: This option reverses the order of the events, showing the most recent events first. This is useful for quickly identifying the latest activities.
* **`/f:text`**: This option specifies the format of the output. In this case, we are requesting the output in plain text format.
* **`| Select-String "/user"`**: This part of the command pipes the output to the `Select-String` cmdlet, which filters the results to only include lines that contain the string `/user`. This is particularly useful for identifying log entries related to user account actions.

**Sample Output**

The command may produce output similar to the following:

```perl
Process Command Line:   net use T: \\dbs\backups /user:dollar P@ssword
```

**Interpretation of the Output**

* The output indicates that a command was executed to establish a network connection to `\\dbs\backups` using the specified username (dollar) and password (`P@ssword`).
* This information can be crucial for security analysis, as it reveals user activity related to network shares, which could potentially indicate unauthorized access or misuse of credentials.

#### **Conclusion**

Using `wevtutil` to search through security logs can provide valuable insights into user activities and potential security incidents. The ability to filter results with `Select-String` allows for more focused analysis, making it easier to spot suspicious behavior or investigate incidents.
